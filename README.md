# cons_for_OMS

Необходимые пакеты для работы создания консенсуса

biopython==1.83  
cutadapt==4.8

Установить их можно с помощью pip 

pip install biopython==1.83  
pip install cutadapt==4.8


Для запуска нужно скачать всё и положить рядом, также нужно дать права на исполнение файлов minimap2 и muscle.  

```bash
chmod +x muscle3.8.31_i86linux64
chmod +x minimap2-2.28_x64-linux/minimap2
```

для примера можно использовать файлы adaptor.fasta и outSNR8.fasta  
По результатам работы скрипта должен получиться консенсус со 100% точностью.

# Примеры использования

Есть две возможности использования кода, через терминал или импортируя его в python скрипт.

### Пример использования через терминал:

Минимальный набор для запуска это путь до файла с адаптером и файла с полимеразным прочтением  

```bash
python consensus.py -a путь до файла с адаптером в формате fasta
-r путь до файла с полимеразным прочтением в формате fasta, fastq или sam 
```

Также можно добавить полный путь до выходной папки
```bash
python consensus.py -a путь до файла с адаптером в формате fasta
-r путь до файла с полимеразным прочтением в формате fasta, fastq или sam
-o Полный путь до папки, куда будут записаны результаты 
```

Если файл muscle не находится в той же папке, откуда запускается скрипт, то можно записать полный путь до него
```bash
python consensus.py -a путь до файла с адаптером в формате fasta
-r путь до файла с полимеразным прочтением в формате fasta, fastq или sam
-o Полный путь до папки, куда будут записаны результаты -m Полынй путь до исполняемого файла muscle 
```

Также можно добавить имя конечного файла в формате fastq
```bash
python consensus.py -a путь до файла с адаптером в формате fasta
-r путь до файла с полимеразным прочтением в формате fasta, fastq или sam
-o Полный путь до папки, куда будут записаны результаты -m Полынй путь до исполняемого файла muscle
-n Имя файла, куда будет записан консенсус.fastq
```

Если папка minimap2 не находится в той же папке, откуда запускается скрипт, то можно записать полный путь до папки
```bash
python consensus.py -a путь до файла с адаптером в формате fasta
-r путь до файла с полимеразным прочтением в формате fasta, fastq или sam
-o Полный путь до папки, куда будут записаны результаты -m Полынй путь до исполняемого файла muscle
-n Имя файла, куда будет записан консенсус.fastq -s Полный путь до исполняемого файла minimap2
```
Также можно набрать python consensus.py -h для информации об аргументах

### Примеры использования с помощью импорта скрипта представлены в файле test_run_consensus.ipynb



## Выходные файлы
По итогу работы скрипта будут следующие результаты:
- consensus_final.fastq - финальное консенсусное прочтение или другое имя файла, если было указано
- consensus.fastq - консенсусное прочтение из прямых прочтений
- consensus_compl.fastq - консенсусное прочтение из обратных прочтений
- папка allig - папка с выравниваниями маленьких кусков при создании консенсуса из прямых прочтений
- папка allig_compl - папка с выравниваниями маленьких кусков при создании консенсуса из обратных прочтений
- multiple_alignment.fasta - множественное выравнивание из нескольких консенсусов, созданных из прямых прочтений, с разными параметрами 
- multiple_alignment_compl.fasta - множественное выравнивание из нескольких консенсусов, созданных из обратных прочтений, с разными параметрами
- reads.fasta - все прочтения после вырезки адаптеров
- real_reads.fasta - прямые прочтения после вырезки адаптеров и сортировки
- real_reads_compl.fasta - обратные прочтения после вырезки адаптеров и сортировки




